<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5">
    <title>ç™¾å¤œ | å­¦æœ¯ä¸äºŒæ¬¡å…ƒ</title>
    <meta name="description" content="SYSUæ•°å­¦ç³»å¤§ä¸‰åœ¨è¯»ï¼ŒäºŒæ¬¡å…ƒçˆ±å¥½è€…ï¼ŒæŠ€æœ¯åšå®¢">
    <meta name="keywords" content="ä¸ªäººåšå®¢,å¼€å‘è€…,æ•°å­¦,ç¼–ç¨‹,äºŒæ¬¡å…ƒ">
    <meta name="format-detection" content="telephone=no">
    <link rel="shortcut icon" href="favicon.ico">

    <!-- CSS CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.css">

    <link rel="stylesheet" href="assets/css/style.css">
    
    <!-- å‰å°ç‰¹æœ‰æ ·å¼ -->
    <style>
        .readonly-badge {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(103, 81, 185, 0.2);
            color: #c3b5f5;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            z-index: 1000;
        }
        
        .github-storage-info {
            text-align: center;
            margin-top: 20px;
            font-size: 12px;
            color: #a0aec0;
        }
        
        .github-storage-info i {
            margin-right: 5px;
        }
        
        /* åŠ è½½çŠ¶æ€æ ·å¼ */
        .loading {
            text-align: center;
            padding: 20px;
            color: #a0aec0;
        }
        
        .loading-spinner {
            border: 3px solid rgba(103, 81, 185, 0.3);
            border-top: 3px solid #6751b9;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .empty-info {
            padding: 20px;
            text-align: center;
            color: #a0aec0;
            font-style: italic;
        }
        
        .error-info {
            padding: 20px;
            text-align: center;
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 8px;
            margin: 10px;
            background: rgba(239, 68, 68, 0.1);
        }
    </style>
</head>

<body>
    <div class="readonly-badge">
        <i class="fa fa-eye"></i> å±•ç¤ºæ¨¡å¼
    </div>
    
    <div id="body-wrap">
        <!-- å¯¼èˆªæ  -->
        <nav>
            <div id="site-title">
                <span class="blogtitle">ç™¾å¤œ | å­¦æœ¯ä¸äºŒæ¬¡å…ƒ</span>
            </div>
        </nav>

        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <div class="layout_container">
            <!-- ä¾§è¾¹æ ï¼šä¸ªäººèµ„æ–™å¡ç‰‡ -->
            <div class="aside_content">
                <div class="card profile-card">
                    <div class="profile-avatar">
                        <img src="https://images3.alphacoders.com/135/thumb-1920-1358482.png" alt="å¤´åƒ">
                    </div>
                    <h2 class="profile-name">æ‘¸é±¼çˆ±å¥½è€…</h2>
                    <p class="profile-bio">SYSUæ•°å­¦ç³»å¤§ä¸‰åœ¨è¯»<br>äºŒæ¬¡å…ƒçˆ±å¥½è€… | å‰ç«¯å¼€å‘è€…<br>æ°¸è¿œä¿æŒæ±‚çŸ¥æ¬²</p>
                    
                    <div class="profile-tags">
                        <span class="tag">æ•°å­¦</span>
                        <span class="tag">ç¼–ç¨‹</span>
                        <span class="tag">äºŒæ¬¡å…ƒ</span>
                        <span class="tag">åŠ¨æ¼«</span>
                        <span class="tag">æ¸¸æˆ</span>
                    </div>
                    
                    <div class="social-links">
                        <a href="https://github.com" class="social-link" target="_blank">
                            <i class="fa fa-github"></i>
                        </a>
                        <a href="#" class="social-link" target="_blank">
                            <i class="fa fa-weibo"></i>
                        </a>
                        <a href="#" class="social-link" target="_blank">
                            <i class="fa fa-bilibili"></i>
                        </a>
                        <a href="#" class="social-link" target="_blank">
                            <i class="fa fa-zhihu"></i>
                        </a>
                    </div>
                </div>

                <!-- ä»Šæ—¥å¿ƒæƒ…å¡ç‰‡ -->
                <div class="card mood-card">
                    <div class="card-header">
                        <div class="card-icon">
                            <i class="fa fa-heart"></i>
                        </div>
                        <h3 class="card-title">ä»Šæ—¥å¿ƒæƒ…</h3>
                    </div>
                    <div id="mood-display" class="loading">
                        <div class="loading-spinner"></div>
                        <p>åŠ è½½å¿ƒæƒ…ä¸­...</p>
                    </div>
                </div>

                <!-- ç»Ÿè®¡æ•°æ®å¡ç‰‡ -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">
                            <i class="fa fa-bar-chart"></i>
                        </div>
                        <h3 class="card-title">å­¦ä¹ æ•°æ®</h3>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="focus-today">0h</div>
                            <div class="stat-label">ä»Šæ—¥ä¸“æ³¨</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="total-pomodoro">0</div>
                            <div class="stat-label">ç´¯è®¡ç•ªèŒ„</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="current-streak">0</div>
                            <div class="stat-label">è¿ç»­å¤©æ•°</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ä¸»å†…å®¹åŒºåŸŸ -->
            <div class="main_content">
                <div class="card music-card">
                    <div class="card-header">
                        <div class="card-icon">
                            <i class="fa fa-music"></i>
                        </div>
                        <h3 class="card-title">å­¦ä¹ éŸ³ä¹</h3>
                    </div>
                    <div id="aplayer"></div>
                </div>

                <!-- ç•ªèŒ„é’Ÿå¡ç‰‡ -->
                <div class="card pomodoro-card">
                    <div class="pomodoro-header">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fa fa-clock-o"></i>
                            </div>
                            <h3 class="card-title">å­¦æœ¯ç•ªèŒ„é’Ÿ</h3>
                        </div>
                        <div class="timer-status" id="timer-status">å‡†å¤‡å¼€å§‹</div>
                    </div>
                    
                    <div class="pomodoro-timer">
                        <div class="timer-display" id="timer-display">25:00</div>
                    </div>
                    
                    <div class="pomodoro-controls" style="margin-top: 20px; text-align: center;">
                        <button class="btn btn-primary" id="start-btn" style="margin: 5px;">
                            <i class="fa fa-play"></i> å¼€å§‹
                        </button>
                        <button class="btn btn-secondary" id="pause-btn" style="margin: 5px; display:none;">
                            <i class="fa fa-pause"></i> æš‚åœ
                        </button>
                        <button class="btn btn-secondary" id="reset-btn" style="margin: 5px;">
                            <i class="fa fa-refresh"></i> é‡ç½®
                        </button>
                    </div>
                    
                    <div class="pomodoro-history">
                        <h4 class="history-title">ä»Šæ—¥ä¸“æ³¨è®°å½•</h4>
                        <div class="history-list" id="history-list">
                            <div class="loading">
                                <div class="loading-spinner"></div>
                                <p>åŠ è½½è®°å½•ä¸­...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æƒ³æ³•å¡ç‰‡ -->
                <div class="card thoughts-card">
                    <div class="card-header">
                        <div class="card-icon">
                            <i class="fa fa-pencil"></i>
                        </div>
                        <h3 class="card-title">ä»Šæ—¥æƒ³æ³•</h3>
                    </div>
                    
                    <div class="thoughts-list" id="thoughts-list">
                        <div class="loading">
                            <div class="loading-spinner"></div>
                            <p>åŠ è½½æƒ³æ³•ä¸­...</p>
                        </div>
                    </div>
                    
                    <div class="github-storage-info">
                        <i class="fa fa-github"></i> æ•°æ®å­˜å‚¨äº GitHub Issues
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <div id="footer-wrap">
                <div class="copyright">&copy; 2023 ç™¾å¤œ | ä¸­å±±å¤§å­¦æ•°å­¦ç³»</div>
                <div style="margin-top: 10px; font-size: 0.8rem; color: #a0aec0;">
                    <a href="admin.html" style="color: #8a74f9; text-decoration: none;">
                        <i class="fa fa-lock"></i> è¿›å…¥ç®¡ç†åå°
                    </a>
                </div>
            </div>
        </footer>
    </div>

    <!-- JS CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script>
    <script src="https://unpkg.com/meting@2/dist/Meting.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.11/typed.min.js"></script>
    
    <!-- é¡¹ç›® JS æ–‡ä»¶ -->
    <script src="js/github-api.js"></script>
    <script src="js/main.js"></script>
    <script src="js/thoughts.js"></script>
    <script src="js/pomodoro.js"></script>
    
    <!-- åˆå§‹åŒ–é€»è¾‘ - è¿™æ˜¯ä¿®å¤çš„æ ¸å¿ƒéƒ¨åˆ† -->
    <script>
        // å¤‡ç”¨æ•°æ® - å½“GitHubä¸å¯ç”¨æ—¶ä½¿ç”¨
        const FALLBACK_DATA = {
            mood: "ğŸŒ ä»Šå¤©å¤©æ°”ä¸é”™ï¼Œå‡†å¤‡å¼€å§‹ä¸€å¤©çš„å­¦ä¹ ï¼<br>ğŸ“š è®¡åˆ’å­¦ä¹ çº¿æ€§ä»£æ•°å’Œå‰ç«¯å¼€å‘",
            thoughts: [
                {
                    title: "å­¦ä¹ å¿ƒå¾—",
                    body: "ä»Šå¤©å­¦ä¹ äº†çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ï¼Œçº¿æ€§å˜æ¢çš„æ¦‚å¿µå¾ˆæœ‰è¶£ã€‚",
                    created_at: new Date().toISOString()
                },
                {
                    title: "ç¼–ç¨‹æ€è€ƒ", 
                    body: "å‰ç«¯å¼€å‘ä¸­ï¼Œç”¨æˆ·ä½“éªŒå’Œæ€§èƒ½ä¼˜åŒ–åŒæ ·é‡è¦ã€‚",
                    created_at: new Date(Date.now() - 2*60*60*1000).toISOString()
                },
                {
                    title: "äºŒæ¬¡å…ƒåˆ†äº«",
                    body: "æœ€è¿‘åœ¨çœ‹ã€Šé—´è°è¿‡å®¶å®¶ã€‹ï¼Œå®‰å¦®äºšå¤ªå¯çˆ±äº†ï¼",
                    created_at: new Date(Date.now() - 4*60*60*1000).toISOString()
                }
            ],
            pomodoros: [
                { created_at: new Date().toISOString() },
                { created_at: new Date(Date.now() - 60*60*1000).toISOString() },
                { created_at: new Date(Date.now() - 3*60*60*1000).toISOString() }
            ]
        };
        
        // é¡µé¢é…ç½®
        const PAGE_CONFIG = {
            // é»˜è®¤ä½¿ç”¨EstherChernçš„ä»“åº“ï¼Œå¦‚æœä¸å­˜åœ¨ä¼šä½¿ç”¨å¤‡ç”¨æ•°æ®
            repoOwner: 'EstherChern',
            repoName: 'EstherChern.github.io',
            useFallback: true // å¼€å¯å¤‡ç”¨æ•°æ®åŠŸèƒ½
        };
        
        let githubAPI = null;
        let useFallbackMode = false;
        
        // æ˜¾ç¤ºæ¶ˆæ¯å‡½æ•°
        function showMessage(message, type = 'info') {
            console.log(`[${type}] ${message}`);
            
            // å¦‚æœæ˜¯é”™è¯¯æˆ–è­¦å‘Šï¼Œåœ¨æ§åˆ¶å°æ˜¾ç¤º
            if (type === 'error' || type === 'warning') {
                // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ é¡µé¢æç¤ºï¼Œä½†å…ˆä¿æŒç®€å•
            }
        }
        
        // åŠ è½½å¤‡ç”¨æ•°æ®
        function loadFallbackData() {
            console.log('ä½¿ç”¨å¤‡ç”¨æ•°æ®æ¨¡å¼');
            useFallbackMode = true;
            
            // 1. åŠ è½½å¿ƒæƒ…
            const moodDisplay = document.getElementById('mood-display');
            if (moodDisplay) {
                moodDisplay.innerHTML = `<div class="mood-content">${FALLBACK_DATA.mood}</div>`;
                moodDisplay.classList.remove('loading');
            }
            
            // 2. åŠ è½½æƒ³æ³•
            const thoughtsList = document.getElementById('thoughts-list');
            if (thoughtsList) {
                const thoughtsHtml = FALLBACK_DATA.thoughts.map((thought, index) => `
                    <div class="thought-item">
                        <div class="thought-meta">
                            <strong>${thought.title}</strong>
                            <span class="time">
                                ${new Date(thought.created_at).toLocaleTimeString('zh-CN', {
                                    hour: '2-digit',
                                    minute: '2-digit'
                                })}
                            </span>
                        </div>
                        <div class="thought-body">${thought.body}</div>
                    </div>
                `).join('');
                
                thoughtsList.innerHTML = thoughtsHtml;
            }
            
            // 3. åŠ è½½ç•ªèŒ„é’Ÿè®°å½•
            const historyList = document.getElementById('history-list');
            if (historyList) {
                const historyHtml = FALLBACK_DATA.pomodoros.map((pomodoro, index) => {
                    const time = new Date(pomodoro.created_at).toLocaleTimeString('zh-CN', {
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    return `
                        <div class="history-item">
                            <i class="fa fa-check-circle" style="color:#4ade80; margin-right:8px;"></i>
                            ${time} - å®Œæˆ25åˆ†é’Ÿä¸“æ³¨
                        </div>
                    `;
                }).join('');
                
                historyList.innerHTML = historyHtml;
            }
            
            // 4. æ›´æ–°ç»Ÿè®¡æ•°æ®
            document.getElementById('total-pomodoro').textContent = FALLBACK_DATA.pomodoros.length;
            const todayFocusMinutes = FALLBACK_DATA.pomodoros.length * 25;
            const todayHours = Math.floor(todayFocusMinutes / 60);
            const todayMinutes = todayFocusMinutes % 60;
            document.getElementById('focus-today').textContent = 
                (todayHours > 0 ? todayHours + 'h' : '') + todayMinutes + 'm';
        }
        
        // åŠ è½½æ•°æ®çš„ä¸»è¦å‡½æ•°
        async function loadAllData() {
            console.log('å¼€å§‹åŠ è½½æ•°æ®...');
            
            try {
                // 1. åˆå§‹åŒ–GitHub API
                githubAPI = new GitHubAPI(null, PAGE_CONFIG.repoOwner, PAGE_CONFIG.repoName);
                
                // 2. æµ‹è¯•è¿æ¥ï¼ˆä¸é˜»å¡åç»­åŠ è½½ï¼‰
                setTimeout(async () => {
                    try {
                        const test = await githubAPI.testConnection();
                        console.log('GitHubè¿æ¥æµ‹è¯•:', test);
                    } catch (error) {
                        console.warn('GitHubè¿æ¥æµ‹è¯•å¤±è´¥:', error.message);
                    }
                }, 1000);
                
                // 3. å°è¯•ä»GitHubåŠ è½½æ•°æ®ï¼Œå¦‚æœå¤±è´¥åˆ™ä½¿ç”¨å¤‡ç”¨æ•°æ®
                try {
                    // å¹¶è¡ŒåŠ è½½å¿ƒæƒ…å’Œæƒ³æ³•
                    const [mood, thoughts, pomodoros] = await Promise.allSettled([
                        githubAPI.getTodayMood(),
                        githubAPI.getIssues({ 
                            labels: ['thought', 'personal-blog'],
                            per_page: 10 
                        }),
                        githubAPI.getIssues({ 
                            labels: ['pomodoro', 'personal-blog'],
                            per_page: 50 
                        })
                    ]);
                    
                    console.log('GitHubæ•°æ®åŠ è½½ç»“æœ:', { mood, thoughts, pomodoros });
                    
                    // å¤„ç†å¿ƒæƒ…æ•°æ®
                    const moodDisplay = document.getElementById('mood-display');
                    if (moodDisplay) {
                        if (mood.status === 'fulfilled' && mood.value) {
                            moodDisplay.innerHTML = `<div class="mood-content">${mood.value.body || 'ä»Šå¤©å¿ƒæƒ…ä¸é”™~'}</div>`;
                        } else {
                            moodDisplay.innerHTML = `<div class="mood-content" style="color:#a0aec0; font-style: italic;">ä»Šå¤©è¿˜æ²¡æœ‰è®°å½•å¿ƒæƒ…</div>`;
                        }
                        moodDisplay.classList.remove('loading');
                    }
                    
                    // å¤„ç†æƒ³æ³•æ•°æ®
                    const thoughtsList = document.getElementById('thoughts-list');
                    if (thoughtsList) {
                        if (thoughts.status === 'fulfilled' && thoughts.value && thoughts.value.length > 0) {
                            // ä½¿ç”¨thoughtsManageræ˜¾ç¤ºæƒ³æ³•
                            if (window.thoughtsManager && typeof window.thoughtsManager.displayThoughts === 'function') {
                                window.thoughtsManager.displayThoughts(thoughts.value, 'thoughts-list');
                            } else {
                                // å¤‡ç”¨æ˜¾ç¤ºæ–¹å¼
                                const html = thoughts.value.map(issue => `
                                    <div class="thought-item">
                                        <div class="thought-meta">
                                            <strong>${issue.title || 'æƒ³æ³•'}</strong>
                                            <span class="time">
                                                ${new Date(issue.created_at).toLocaleTimeString('zh-CN', {
                                                    hour: '2-digit',
                                                    minute: '2-digit'
                                                })}
                                            </span>
                                        </div>
                                        <div class="thought-body">${issue.body || ''}</div>
                                    </div>
                                `).join('');
                                thoughtsList.innerHTML = html;
                            }
                        } else {
                            thoughtsList.innerHTML = '<div class="empty-info">è¿˜æ²¡æœ‰æƒ³æ³•è®°å½•</div>';
                        }
                    }
                    
                    // å¤„ç†ç•ªèŒ„é’Ÿæ•°æ®
                    const historyList = document.getElementById('history-list');
                    if (historyList) {
                        if (pomodoros.status === 'fulfilled' && pomodoros.value) {
                            const today = new Date().toISOString().split('T')[0];
                            const todayRecords = pomodoros.value.filter(issue => {
                                try {
                                    const issueDate = new Date(issue.created_at).toISOString().split('T')[0];
                                    return issueDate === today;
                                } catch {
                                    return false;
                                }
                            });
                            
                            if (todayRecords.length === 0) {
                                historyList.innerHTML = '<div class="history-item">ä»Šå¤©è¿˜æ²¡æœ‰è®°å½•</div>';
                            } else {
                                const historyHtml = todayRecords.slice(0, 5).map(issue => {
                                    const time = new Date(issue.created_at).toLocaleTimeString('zh-CN', {
                                        hour: '2-digit',
                                        minute: '2-digit'
                                    });
                                    return `
                                        <div class="history-item">
                                            <i class="fa fa-check-circle" style="color:#4ade80; margin-right:8px;"></i>
                                            ${time} - å®Œæˆ25åˆ†é’Ÿä¸“æ³¨
                                        </div>
                                    `;
                                }).join('');
                                historyList.innerHTML = historyHtml;
                                
                                // æ›´æ–°ç»Ÿè®¡æ•°æ®
                                document.getElementById('total-pomodoro').textContent = pomodoros.value.length;
                                const todayFocusMinutes = todayRecords.length * 25;
                                const todayHours = Math.floor(todayFocusMinutes / 60);
                                const todayMinutes = todayFocusMinutes % 60;
                                document.getElementById('focus-today').textContent = 
                                    (todayHours > 0 ? todayHours + 'h' : '') + todayMinutes + 'm';
                            }
                        } else {
                            historyList.innerHTML = '<div class="history-item">åŠ è½½è®°å½•å¤±è´¥</div>';
                        }
                    }
                    
                    console.log('GitHubæ•°æ®åŠ è½½å®Œæˆ');
                    
                } catch (error) {
                    console.error('ä»GitHubåŠ è½½æ•°æ®å¤±è´¥:', error);
                    
                    // å¦‚æœé…ç½®å…è®¸ï¼Œä½¿ç”¨å¤‡ç”¨æ•°æ®
                    if (PAGE_CONFIG.useFallback) {
                        showMessage('GitHubæ•°æ®åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ•°æ®', 'warning');
                        loadFallbackData();
                    } else {
                        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                        const errorDivs = document.querySelectorAll('.loading');
                        errorDivs.forEach(div => {
                            div.innerHTML = '<div class="error-info">æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥</div>';
                            div.classList.remove('loading');
                        });
                    }
                }
                
            } catch (error) {
                console.error('åˆå§‹åŒ–å¤±è´¥:', error);
                if (PAGE_CONFIG.useFallback) {
                    loadFallbackData();
                }
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        $(document).ready(function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–...');
            
            // 1. åˆå§‹åŒ–æ ‡é¢˜åŠ¨ç”»
            try {
                var typed = new Typed(".blogtitle", {
                    strings: ['ç™¾å¤œ | å­¦æœ¯ä¸äºŒæ¬¡å…ƒ', 'ç™¾å¤œ | æ•°å­¦ä¸ç¼–ç¨‹', 'ç™¾å¤œ | ä¸“æ³¨ä¸åˆ›é€ '],
                    startDelay: 300,
                    typeSpeed: 100,
                    loop: true,
                    backSpeed: 50,
                    showCursor: true
                });
            } catch (error) {
                console.warn('æ ‡é¢˜åŠ¨ç”»åˆå§‹åŒ–å¤±è´¥:', error);
            }
            
            // 2. åˆå§‹åŒ–éŸ³ä¹æ’­æ”¾å™¨
            try {
                const ap = new APlayer({
                    container: document.getElementById('aplayer'),
                    audio: [{
                        name: 'å­¦ä¹ ä¸“æ³¨éŸ³ä¹',
                        artist: 'çº¯éŸ³ä¹',
                        url: 'https://music.163.com/song/media/outer/url?id=1859245776.mp3',
                        cover: 'https://p2.music.126.net/y-pQkLXU4Z5aXkQzSDSjag==/109951166118847666.jpg'
                    }],
                    volume: 0.7,
                    fixed: false,
                    mini: false,
                    autoplay: false,
                    theme: '#6751b9'
                });
            } catch (error) {
                console.warn('éŸ³ä¹æ’­æ”¾å™¨åˆå§‹åŒ–å¤±è´¥:', error);
            }
            
            // 3. åŠ è½½æ•°æ®
            setTimeout(() => {
                loadAllData();
            }, 500);
            
            // 4. ç»‘å®šç•ªèŒ„é’ŸæŒ‰é’®äº‹ä»¶
            document.addEventListener('click', function(e) {
                if (e.target.id === 'start-btn' || e.target.closest('#start-btn')) {
                    if (window.pomodoroManager && typeof window.pomodoroManager.start === 'function') {
                        window.pomodoroManager.start();
                    }
                }
                
                if (e.target.id === 'pause-btn' || e.target.closest('#pause-btn')) {
                    if (window.pomodoroManager && typeof window.pomodoroManager.pause === 'function') {
                        window.pomodoroManager.pause();
                    }
                }
                
                if (e.target.id === 'reset-btn' || e.target.closest('#reset-btn')) {
                    if (window.pomodoroManager && typeof window.pomodoroManager.reset === 'function') {
                        window.pomodoroManager.reset();
                    }
                }
            });
        });
        
        // å…¨å±€é”™è¯¯å¤„ç†
        window.addEventListener('error', function(e) {
            console.error('å…¨å±€é”™è¯¯:', e.error);
        });
        
        // æš´éœ²å¿…è¦çš„æ–¹æ³•åˆ°å…¨å±€
        window.loadAllData = loadAllData;
        window.PAGE_CONFIG = PAGE_CONFIG;
    </script>
</body>
</html>
